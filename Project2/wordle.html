<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.6">
  <link rel="icon" type="image/png" href="favicon.png">
  <title>Wordle</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      text-align: center;
      margin: 40px;
    }

    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }

    #title {
      font-size: 2.5em;
      font-weight: bold;
      letter-spacing: 6px;
    }

    #title span {
      -webkit-text-stroke: 1px black;
    }
    .gray {
      color: gray;
    }

    .green {
      color: green;
    }

    .yellow {
      color: yellow;
    }

    #modeToggle {
      margin-bottom: 15px;
      font-size: 0.9em;
    }
    #modeToggle input {
      transform: scale(1.2);
      margin-right: 6px;
    }

    #board {
      display: grid;
      grid-template-rows: repeat(6, 1fr);
      gap: 5px;
      width: 290px; /* 50*5 + 10*4 */
      margin: 0 auto 20px;
    }

    .row {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 5px;
    }

    .cell {
      width: 50px;
      height: 50px;
      border: 2px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5em;
      text-transform: uppercase;
      background: white;
    }

    #controls {
      margin-top: 20px;
    }

    #guessInput {
      font-size: 1em;
      padding: 6px;
      width: 120px;
      text-transform: uppercase;
      background-color: #d9fdd3;
      border: 2px solid #6aaa64;
      color: #2e2e2e;
      border-radius: 4px;
    }

    #guessInput:focus {
      outline: none;
      border-color: #4e9a46;
      background-color: #c9f7be;
    }

    #submitBtn, #restartBtn {
      font-size: 1em;
      padding: 6px 12px;
      margin-left: 5px;
      cursor: pointer;
      background-color: #fff8b3;
      border: 1px solid #e0d47a;
      color: #333;
      border-radius: 6px;
    }

    #restartBtn {
      display: none;
    }
    
    #keyboard {
      margin-top: 20px;
    }

    #enterBtn,
    #deleteBtn {
      background-color: gray;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 12px;
    }

    #enterBtn:hover,
    #deleteBtn:hover {
      background-color: #555555;
    }


    .kb-row {
      display: flex;
      justify-content: center;
      margin: 4px 0;
    }

    .kb-row button {
      margin: 2px;
      padding: 8px 10px;
      font-size: 1em;
      text-transform: uppercase;
      cursor: pointer;
    }



  </style>
</head>
<body>
  <h1 id="title">
    <span class="gray">W</span>
    <span class="green">O</span>
    <span class="yellow">R</span>
    <span class="gray">D</span>
    <span class="green">L</span>
    <span class="yellow">E</span>
  </h1>

  <div id="modeToggle">
    <label>
      <input type="checkbox" id="apiSwitch">
      Use API for random word
    </label>
  </div>

  <div id="board">
    <script>
      for (let i = 0; i < 6; i++) {
        document.write('<div class="row">');
        for (let j = 0; j < 5; j++) {
          document.write('<div class="cell" id="cell-' + i + '-' + j + '"></div>');
        }
        document.write('</div>');
      }
    </script>
  </div>

  <div id="controls">
    <input type="text" id="guessInput" placeholder="Your guess">
    <button id="submitBtn">Guess</button>
    <button id="restartBtn">Restart</button>
  </div>

  <div id="keyboard">
    <div class="kb-row">
      <button>Q</button><button>W</button><button>E</button><button>R</button><button>T</button>
      <button>Y</button><button>U</button><button>I</button><button>O</button><button>P</button>
    </div>
    <div class="kb-row">
      <button>A</button><button>S</button><button>D</button><button>F</button><button>G</button>
      <button>H</button><button>J</button><button>K</button><button>L</button>
    </div>
    <div class="kb-row">
      <button id="enterBtn">Enter</button>
      <button>Z</button><button>X</button><button>C</button><button>V</button><button>B</button><button>N</button><button>M</button>
      <button id="deleteBtn">⬅</button>
    </div>
  </div>


  <div id="message"></div>

  <script>

    /*********************************** FUNCTIONS ***********************************/

    // Generate an answer
    let useAPI = false;
    let answer = "";

    function pickAnswer() {
      if (!useAPI) {
        const words = [
          "ARRAY", "LOGIC", "STACK", "QUEUE", "INPUT", "TOKEN", "CACHE", "BUGGY", "SPACE", "BYTES", 
          "INDEX", "CLASS", "FLOAT", "LOGIN", "LEARN", "FILES", "STUDY", "RECUR", "QUERY", "PROTO", 
          "BASIC", "VIRUS", "CLOUD", "ROBOT", "PIXEL", "ALERT", "DEBUG", "FRAME", "PATCH", "BRAIN"
        ];
        answer = words[Math.floor(Math.random() * words.length)];
        console.log("Answer from Array:", answer);
      } else {
        fetch("https://random-word-api.herokuapp.com/word?length=5")
        .then(res => res.json())
        .then(data => {
          answer = data[0].toUpperCase();
          console.log("Answer from API:", answer);
        });
      }
    }

    // Clear board and keyboard, switch (restartBtn) back to sumbitBtn
    function clearEverything() {
      document.getElementById("guessInput").value = "";
      document.getElementById("message").textContent = "";
      document.querySelectorAll(".cell").forEach(cell => { // clear board
        cell.textContent = "";
        cell.style.background = "white";
      });
      document.querySelectorAll("#keyboard button").forEach(btn => { // clear keyboard
        btn.style.background = "";
        btn.style.color = "";
      });
      document.getElementById("restartBtn").style.display = "none"; // switch button
      document.getElementById("submitBtn").style.display = "inline-block";
    }

    /*********************************** ACTIONS ***********************************/


    pickAnswer(); // Generate an answer after the page is loaded (with out hitting the restartBtn!)

    // Click api-switch
    document.getElementById("apiSwitch").addEventListener("change", (e) => {
      useAPI = e.target.checked;
      pickAnswer();
      clearEverything();
    });

    // Restart button logic (change answer & clear board)
    document.getElementById("restartBtn").addEventListener("click", () => {
      pickAnswer();
      clearEverything();
    });

    // Make on-screen keyboard buttons type into the input
    document.querySelectorAll("#keyboard button").forEach(btn => {
      btn.addEventListener("click", () => {
        const input = document.getElementById("guessInput");
        const key = btn.textContent;
        if (btn.id == "enterBtn") {
          document.getElementById("submitBtn").click();
          return;
        }
        if (btn.id == "deleteBtn") {
          input.value = input.value.slice(0, -1);
          return;
        }
        if (input.value.length < 5 && key.length === 1) {
          input.value += key;
        }
      });
    });

    // MAIN LOGIC HERE (click submit)
    let currentRow = 0;
    document.getElementById('submitBtn').onclick = () => {
      // Length error
      const guess = document.getElementById('guessInput').value.trim().toUpperCase();
      if (guess.length !== 5) {
        alert("Word must be 5 letters!");
        return;
      }
      // Show your guess on board (with color)
      let numCorrectLetters = 0;
      for (let i = 0; i < 5; i++) {
        const cell = document.getElementById(`cell-${currentRow}-${i}`);
        cell.textContent = guess[i];
        const letter = guess[i];
        if (letter === answer[i]) {
          cell.style.background = "green";
          document.querySelectorAll("#keyboard button").forEach(btn => { if (btn.textContent === letter)  btn.style.background = "green"; });
          numCorrectLetters++;
        } else if (answer.includes(letter)) {
          cell.style.background = "yellow";
          document.querySelectorAll("#keyboard button").forEach(btn => { if (btn.textContent === letter)  btn.style.background = "yellow"; });

        } else {
          cell.style.background = "gray";
          document.querySelectorAll("#keyboard button").forEach(btn => { if (btn.textContent === letter)  btn.style.background = "gray"; });
        }
      }
      // Game over
      if (numCorrectLetters == 5) { // SUCCESS!
        currentRow = 0;
        document.getElementById("submitBtn").style.display = "none";
        document.getElementById("restartBtn").style.display = "inline-block";
        // alert("✅✅✅  '" + answer + "'  ✅✅✅");
        setTimeout(() => { alert("✅✅✅  '" + answer + "'  ✅✅✅"); }, 100); // wait for the board and the keyboard to update.
        return;
      }
      if (currentRow == 5) { // FAIL!
        currentRow = 0;
        document.getElementById("submitBtn").style.display = "none";
        document.getElementById("restartBtn").style.display = "inline-block";
        // alert("❌❌❌  '" + answer + "'  ❌❌❌");
        setTimeout(() => { alert("❌❌❌  '" + answer + "'  ❌❌❌"); }, 100); // wait for the board and the keyboard to update.
        return;
      }

      // Game NOT over, continue to next line
      currentRow++;
      document.getElementById('guessInput').value = "";
    };


  </script>
</body>
</html>
